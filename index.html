<!DOCTYPE html>
<html>
<head>
    <title>My Download Addon</title>
    <meta charset="UTF-8">
</head>
<body>
    <script>
        // Your addon configuration
        const manifest = {
            "id": "my.download.addon",
            "version": "1.0.0",
            "name": "ðŸ“¥ My Download Addon",
            "description": "Adds download links to Stremio!",
            "resources": ["stream"],
            "types": ["movie", "series"],
            "idPrefixes": ["tt"],
            "catalogs": []
        };

        // Parse the URL to see what Stremio is requesting
        const path = window.location.pathname;
        
        // IMPORTANT: Return pure JSON for manifest and stream requests
        if (path.includes('manifest.json')) {
            // Return ONLY JSON, no HTML!
            document.write(JSON.stringify(manifest));
            
        } else if (path.includes('/stream/')) {
            // Stremio is asking for streams!
            const parts = path.split('/');
            const type = parts[2]; // movie or series
            const id = parts[3];   // tt1234567
            
            // Create some example streams
            const streams = {
                streams: [
                    {
                        name: "ðŸ“¥ Download HD",
                        title: "Download 1080p (Click to open Real-Debrid)",
                        externalUrl: "https://real-debrid.com/torrents"
                    },
                    {
                        name: "ðŸ“¥ Download SD", 
                        title: "Download 720p (Click to open Real-Debrid)",
                        externalUrl: "https://real-debrid.com/torrents"
                    },
                    {
                        name: "ðŸŽ¬ Stream",
                        title: "Example Stream (YouTube)",
                        url: "https://www.youtube.com/watch?v=dQw4w9WgXcQ"
                    }
                ]
            };
            
            // Return ONLY JSON!
            document.write(JSON.stringify(streams));
            
        } else {
            // Default page for humans
            document.write(`
                <h1>âœ… Your addon is working!</h1>
                <p>To test it:</p>
                <ol>
                    <li>Add this URL to Stremio: <code>${window.location.origin}/manifest.json</code></li>
                    <li>Find any movie or show</li>
                    <li>Click on it</li>
                    <li>You'll see your custom download options!</li>
                </ol>
                <hr>
                <p><strong>Current URL:</strong> ${window.location.href}</p>
                <p><strong>Path:</strong> ${path}</p>
            `);
        }
    </script>
</body>
</html>
